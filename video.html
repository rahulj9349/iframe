<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Agora Join Meeting</title>
  <script src="https://download.agora.io/sdk/release/AgoraRTC_N.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    video, .video-box { width: 320px; height: 240px; background: #000; margin-top: 10px; }
    button { margin-right: 10px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Join Agora Video Meeting</h2>

  <label>App ID:</label><br>
  <input id="appId" value="your_app_id_here" /><br><br>

  <label>UID:</label><br>
  <input id="uid" value="12345" /><br><br>

  <label>Channel Name:</label><br>
  <input id="channel" value="test_channel" /><br><br>

  <label>Video Token:</label><br>
  <textarea id="token" rows="3" cols="60">your_token_here</textarea><br><br>

  <button onclick="joinMeeting()">Join Meeting</button>

  <div id="controls" style="display:none;">
    <button onclick="toggleVideo()">ðŸŽ¥ Toggle Video</button>
    <button onclick="toggleAudio()">ðŸŽ¤ Toggle Audio</button>
  </div>

  <div id="local-video" class="video-box"></div>

  <script>
    let client, localAudioTrack, localVideoTrack;
    let videoEnabled = true, audioEnabled = true;

    async function joinMeeting() {
      const appId = document.getElementById('appId').value.trim();
      const uid = Number(document.getElementById('uid').value.trim());
      const channel = document.getElementById('channel').value.trim();
      const token = document.getElementById('token').value.trim();

      client = AgoraRTC.createClient({ mode: "rtc", codec: "vp8" });
      await client.join(appId, channel, token, uid);

      [localAudioTrack, localVideoTrack] = await AgoraRTC.createMicrophoneAndCameraTracks();

      // Play local video
      const videoEl = document.createElement('div');
      videoEl.id = "local-player";
      document.getElementById('local-video').appendChild(videoEl);
      localVideoTrack.play("local-player");

      await client.publish([localAudioTrack, localVideoTrack]);

      document.getElementById('controls').style.display = 'block';
      alert("âœ… Joined channel: " + channel);
    }

    function toggleVideo() {
      if (!localVideoTrack) return;
      videoEnabled = !videoEnabled;
      if (videoEnabled) {
        localVideoTrack.setEnabled(true);
        alert("ðŸŽ¥ Video started");
      } else {
        localVideoTrack.setEnabled(false);
        alert("ðŸŽ¥ Video stopped");
      }
    }

    function toggleAudio() {
      if (!localAudioTrack) return;
      audioEnabled = !audioEnabled;
      if (audioEnabled) {
        localAudioTrack.setEnabled(true);
        alert("ðŸŽ¤ Audio started");
      } else {
        localAudioTrack.setEnabled(false);
        alert("ðŸŽ¤ Audio muted");
      }
    }
  </script>
</body>
</html>
